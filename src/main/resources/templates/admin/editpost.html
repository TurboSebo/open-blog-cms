<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout :: head('Edytuj post - Open Blog CMS')"></head>
<body th:replace="layout :: layout('Edytuj post - Open Blog CMS', ~{::article})">

<article>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>Edytuj wpis</h2>
        <a th:href="@{/admin}" class="button secondary">← Anuluj i wróć</a>
    </div>

    <!-- Quill CSS i style osadzone w article -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <style>
        #editor-container {
            background-color: #ffffff;
            color: #000000;
            height: 300px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
        }
        .ql-toolbar {
            background-color: #f3f4f6;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
        }
        .editor-mode-switch {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .editor-mode-switch .button--active {
            background-color: var(--c-primary);
            color: #fff;
        }
    </style>

    <form id="edit-post-form" th:object="${post}">
        <input type="hidden" id="post-id" th:value="${post.id}">

        <label for="title">Tytuł wpisu</label>
        <input type="text" id="title" name="title" th:value="${post.title}" placeholder="Wpisz tytuł..." required>

        <label>Treść</label>

        <!-- Przełącznik trybu edycji -->
        <div class="editor-mode-switch">
            <span>Tryb edycji:</span>
            <button type="button" id="btn-editor-quill" class="button secondary button--active">Edytor wizualny</button>
            <button type="button" id="btn-editor-html" class="button secondary">Czysty HTML</button>
        </div>

        <!-- Kontener Quilla z treścią z bazy -->
        <div id="editor-container" th:utext="${post.content}"></div>

        <!-- Tekstowy edytor HTML (ukryty domyślnie, wypełniony tą samą treścią) -->
        <textarea id="editor-raw-html"
                  name="contentRaw"
                  rows="12"
                  style="display:none; width:100%; font-family:monospace; font-size:0.9rem;"
                  th:text="${post.content}"></textarea>

        <div style="margin: 20px 0;">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                <input type="checkbox" id="published" name="published"
                       style="width: auto; margin: 0;" th:checked="${post.published}">
                <span>Opublikuj</span>
            </label>
        </div>

        <div class="toolbar">
            <button type="submit">Zapisz zmiany</button>
        </div>
    </form>

    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
</article>

</body>
</html>
